"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[397],{4397:(rt,x,i)=>{i.r(x),i.d(x,{RequestsModule:()=>it});var a=i(6895),b=i(4466),I=i(8252),r=i(9653),g=i(2553),f=i(9884),l=i(1559),q=i(1975),t=i(4650),C=i(6742),p=i(16),L=i(5061),E=i(1572),F=i(7392),v=i(4333),y=i(527),d=i(6460),S=i(5890);function w(s,u){if(1&s&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&s){const e=t.oxw();t.xp6(1),t.AsE("(",e.request.quantity," ",e.getShortenMeasurementUnit(e.request.measurementUnit),")")}}const J=function(){return["h-[45px]","w-[155px]"]},P=function(){return["xl:mt-2","border","border-[#E74C3C]","h-[45px]","w-[155px]"]},R=function(){return["bg-transparent","text-[#E74C3C]"]};function D(s,u){if(1&s){const e=t.EpF();t.TgZ(0,"div",14)(1,"app-button",15),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(2);return t.KtG(o.openEditRequestDialog())}),t.qZA(),t.TgZ(2,"app-button",16),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(2);return t.KtG(o.cancelRequest())}),t.qZA()()}2&s&&(t.xp6(1),t.Q6J("classList",t.DdM(3,J)),t.xp6(1),t.Q6J("classList",t.DdM(4,P))("colors",t.DdM(5,R)))}const N=function(){return["h-[45px]","w-[210px]"]};function M(s,u){if(1&s){const e=t.EpF();t.TgZ(0,"app-button",19),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(3);return t.KtG(o.addRequestToOrder())}),t.qZA()}2&s&&t.Q6J("classList",t.DdM(1,N))}const O=function(){return["h-[45px]","w-[210px]","border","border-[#E74C3C]"]};function Q(s,u){if(1&s){const e=t.EpF();t.TgZ(0,"app-button",20),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(3);return t.KtG(o.deleteRequestFromOrder())}),t.qZA()}2&s&&t.Q6J("classList",t.DdM(2,O))("colors",t.DdM(3,R))}function Y(s,u){if(1&s&&(t.TgZ(0,"div"),t.YNc(1,M,1,2,"app-button",17),t.ALo(2,"async"),t.YNc(3,Q,1,4,"ng-template",null,18,t.W1O),t.qZA()),2&s){const e=t.MAs(4),n=t.oxw(2);let o;t.xp6(1),t.Q6J("ngIf",!(null!=(o=t.lcZ(2,2,n.orderRequests$))&&o.includes(n.request.id)))("ngIfElse",e)}}function U(s,u){if(1&s&&(t.TgZ(0,"div",12),t.YNc(1,D,3,6,"div",13),t.YNc(2,Y,5,4,"div",3),t.qZA()),2&s){const e=u.ngIf,n=t.oxw();t.xp6(1),t.Q6J("ngIf",e.subdivisionId===(null==n.request.subdivision?null:n.request.subdivision.id)&&n.RequestStatuses[n.request.status]===n.RequestStatuses.Active&&e.role===n.Roles.Applicant),t.xp6(1),t.Q6J("ngIf",e.role===n.Roles.Customer)}}const $=function(s){return["mt-2","md:hidden",s]},j=function(s){return["hidden","md:inline-block","h-fit","text-center","md:absolute","md:right-6","md:top-6","xl:static",s]};let k=(()=>{class s{constructor(e){this.store=e,this.measurementUnits=y.A,this.RequestStatuses=d.QK,this.StatusesColors=d.p9,this.getShortenMeasurementUnit=y.k,this.Roles=q.G,this.CategoryTypes=S.y}ngOnInit(){this.user$=this.store.pipe((0,r.Ys)(f.dy)),this.orderRequests$=this.store.pipe((0,r.Ys)(l.Q))}get subdivisionAddress(){const e=this.request.subdivision.address,n=[e.city,e.street];return e.region&&n.splice(1,0,`${e.region} \u043e\u0431\u043b\u0430\u0441\u0442\u044c`),e.buildingNumber&&n.push(e.buildingNumber),n.join(", ")}openEditRequestDialog(){this.store.dispatch(g.Ed({request:this.request}))}cancelRequest(){this.store.dispatch(p.wq({id:this.request.id}))}addRequestToOrder(){this.store.dispatch(p.si({id:this.request.id}))}deleteRequestFromOrder(){this.store.dispatch(p.kW({id:this.request.id}))}}return s.\u0275fac=function(e){return new(e||s)(t.Y36(r.yh))},s.\u0275cmp=t.Xpm({type:s,selectors:[["app-requests-list-item"]],inputs:{request:"request"},decls:26,vars:23,consts:[[1,"mb-4","relative","w-full","bg-white","rounded-xl","shadow-gray-400","p-6"],[1,"xl:grid","xl:grid-cols-[50%_15%_1fr]","xl:gap-x-4","mb-8"],[1,"sm:w-[70%]","xl:w-full","font-semibold","text-xl","text-[#2FCB80]"],[4,"ngIf"],[3,"ngClass"],[1,"mt-2"],[1,"mt-3"],[1,"underline"],[1,"mt-3","italic","text-[#A9A9A9]"],[1,"xl:grid","xl:grid-flow-row","xl:grid-rows-[auto_1fr]","xl:gap-y-3"],[1,"absolute","right-6","bottom-6","xl:static","text-right","italic","text-[#A9A9A9]","text-sm"],["class","mt-5 xl:mt-0 grid justify-center items-center",4,"ngIf"],[1,"mt-5","xl:mt-0","grid","justify-center","items-center"],["class","grid gap-y-2 sm:grid-cols-2 sm:gap-y-0 sm:gap-x-4 xl:grid-cols-1 xl:gap-x-0 justify-center",4,"ngIf"],[1,"grid","gap-y-2","sm:grid-cols-2","sm:gap-y-0","sm:gap-x-4","xl:grid-cols-1","xl:gap-x-0","justify-center"],["text","\u0420\u0435\u0434\u0430\u0433\u0443\u0432\u0430\u0442\u0438","type","button",3,"classList","click"],["text","\u0421\u043a\u0430\u0441\u0443\u0432\u0430\u0442\u0438","type","button",3,"classList","colors","click"],["text","\u0414\u043e\u0434\u0430\u0442\u0438 \u0434\u043e \u0437\u0430\u043c\u043e\u0432\u043b\u0435\u043d\u043d\u044f","type","button",3,"classList","click",4,"ngIf","ngIfElse"],["removeFromOrderBtn",""],["text","\u0414\u043e\u0434\u0430\u0442\u0438 \u0434\u043e \u0437\u0430\u043c\u043e\u0432\u043b\u0435\u043d\u043d\u044f","type","button",3,"classList","click"],["text","\u041f\u0440\u0438\u0431\u0440\u0430\u0442\u0438 \u0456\u0437 \u0437\u0430\u043c\u043e\u0432\u043b\u0435\u043d\u043d\u044f","type","button",3,"classList","colors","click"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div")(3,"h3",2),t._uU(4),t.YNc(5,w,2,2,"span",3),t.qZA(),t.TgZ(6,"p",4),t._uU(7),t.qZA(),t.TgZ(8,"p",5),t._uU(9),t.qZA(),t.TgZ(10,"p",6),t._uU(11,"\u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0456\u044f: "),t.TgZ(12,"span",7),t._uU(13),t.qZA()(),t.TgZ(14,"p",8),t._uU(15),t.qZA(),t.TgZ(16,"p",6),t._uU(17),t.qZA()(),t.TgZ(18,"span",4),t._uU(19),t.qZA(),t.TgZ(20,"div",9)(21,"p",10),t._uU(22),t.ALo(23,"date"),t.qZA(),t.YNc(24,U,3,2,"div",11),t.ALo(25,"async"),t.qZA()()()),2&e&&(t.xp6(4),t.hij("",n.request.procurementItem.title," "),t.xp6(1),t.Q6J("ngIf",n.CategoryTypes[n.request.procurementItem.categoryType]===n.CategoryTypes.Goods),t.xp6(1),t.Q6J("ngClass",t.VKq(19,$,n.StatusesColors[n.request.status])),t.xp6(1),t.Oqu(n.RequestStatuses[n.request.status]),t.xp6(2),t.AsE("",n.request.subdivision.title," (",n.subdivisionAddress,")"),t.xp6(4),t.Oqu(n.request.procurementItem.categoryTitle),t.xp6(2),t.Oqu(n.request.description),t.xp6(2),t.hij("\u0411\u044e\u0434\u0436\u0435\u0442: ",n.request.budget," (\u0433\u0440\u043d.)"),t.xp6(1),t.Q6J("ngClass",t.VKq(21,j,n.StatusesColors[n.request.status])),t.xp6(1),t.Oqu(n.RequestStatuses[n.request.status]),t.xp6(3),t.hij("\u0421\u0442\u0432\u043e\u0440\u0435\u043d\u0430 ",t.Dn7(23,13,n.request.createdAt,"HH:mm:ss dd MMMM y","uk-UA"),""),t.xp6(2),t.Q6J("ngIf",t.lcZ(25,17,n.user$)))},dependencies:[C.r,a.mk,a.O5,a.Ov,a.uU]}),s})();function K(s,u){1&s&&(t.TgZ(0,"div",6)(1,"mat-icon"),t._uU(2,"content_paste_search"),t.qZA(),t.TgZ(3,"span",7),t._uU(4,"\u0417\u0430\u044f\u0432\u043e\u043a \u043d\u0435\u043c\u0430\u0454"),t.qZA()())}function G(s,u){if(1&s&&(t.TgZ(0,"div",4),t.YNc(1,K,5,0,"div",5),t.qZA()),2&s){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",0===e.requests.length)}}function V(s,u){1&s&&t._UZ(0,"app-requests-list-item",12),2&s&&t.Q6J("request",u.$implicit)}const B=function(s,u,e){return{id:"requests",itemsPerPage:s,currentPage:u,totalItems:e}};function H(s,u){if(1&s){const e=t.EpF();t.TgZ(0,"div",8),t.YNc(1,V,1,1,"app-requests-list-item",9),t.ALo(2,"paginate"),t.TgZ(3,"div",10)(4,"pagination-controls",11),t.NdJ("pageChange",function(o){t.CHM(e);const c=t.oxw();return t.KtG(c.pageChanged(o))}),t.qZA()()()}if(2&s){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",t.xi3(2,1,e.requests,t.kEZ(4,B,e.pagination.itemsPerPage,e.pagination.currentPage,e.pagination.totalItems)))}}function X(s,u){1&s&&(t.TgZ(0,"div",13),t._UZ(1,"mat-spinner",14),t.qZA())}let z=(()=>{class s{constructor(e){this.store=e,this.requests=null}ngOnInit(){this.store.dispatch(p.Fd({})),this.requestsSubscription=this.store.pipe((0,r.Ys)(l.QE)).subscribe(e=>{this.requests=e}),this.loading$=this.store.pipe((0,r.Ys)(L.N)),this.paginationSubscription=this.store.pipe((0,r.Ys)(l.B$)).subscribe(e=>{this.pagination=e})}pageChanged(e){this.pagination.currentPage!=e&&this.store.dispatch(p.Fd({pageNumber:e}))}ngOnDestroy(){this.paginationSubscription&&this.paginationSubscription.unsubscribe(),this.requestsSubscription&&this.requestsSubscription.unsubscribe()}}return s.\u0275fac=function(e){return new(e||s)(t.Y36(r.yh))},s.\u0275cmp=t.Xpm({type:s,selectors:[["app-requests-list"]],decls:6,vars:7,consts:[[1,"h-full","w-full","flex","justify-center","relative"],["class","flex flex-col justify-center items-center",4,"ngIf"],["class","w-full",4,"ngIf"],["class","fixed inset-x-[42%] sm:inset-x-[60%] inset-y-[45%]",4,"ngIf"],[1,"flex","flex-col","justify-center","items-center"],["class","flex flex-col items-center",4,"ngIf"],[1,"flex","flex-col","items-center"],[1,"mt-3","text-[#898E96]","font-semibold"],[1,"w-full"],[3,"request",4,"ngFor","ngForOf"],[1,"flex","justify-center"],["id","requests","previousLabel","\u041f\u043e\u043f\u0435\u0440\u0435\u0434\u043d\u044f","nextLabel","\u041d\u0430\u0441\u0442\u0443\u043f\u043d\u0430",1,"request-pagination",3,"pageChange"],[3,"request"],[1,"fixed","inset-x-[42%]","sm:inset-x-[60%]","inset-y-[45%]"],["diameter","70"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0),t.YNc(1,G,2,1,"div",1),t.ALo(2,"async"),t.YNc(3,H,5,8,"div",2),t.YNc(4,X,2,0,"div",3),t.ALo(5,"async"),t.qZA()),2&e&&(t.xp6(1),t.Q6J("ngIf",!t.lcZ(2,3,n.loading$)&&n.requests),t.xp6(2),t.Q6J("ngIf",n.pagination&&(null==n.requests?null:n.requests.length)>0&&n.requests),t.xp6(1),t.Q6J("ngIf",t.lcZ(5,5,n.loading$)||!n.requests))},dependencies:[a.sg,a.O5,E.Ou,F.Hw,v.LS,k,a.Ov,v._s],styles:[".mat-icon[_ngcontent-%COMP%]{scale:2;color:#898e96!important}  .ngx-pagination .current{background-color:#5fcff7!important;border-radius:4px}@media (max-width: 639px){  .pagination-previous,   .pagination-next{display:none!important}}"]}),s})();var m=i(4006),A=i(4004),Z=i(346),_=i(890),W=i(3986);const h=function(){return["value"]};function tt(s,u){if(1&s){const e=t.EpF();t.TgZ(0,"app-dropdown",4),t.NdJ("onSelectionChange",function(o){t.CHM(e);const c=t.oxw();return t.KtG(c.setRequestParamsStatus(o))}),t.qZA()}if(2&s){const e=t.oxw();t.Q6J("control",e.getFormControl("status"))("displayProps",t.DdM(6,h))("items",e.requestStatuses)("optionValueProp","key")("required",!1)("emitSelectionChangeEvent",!0)}}let et=(()=>{class s{constructor(e){this.store=e,this.requestStatuses=[{key:"",value:"\u0412\u0441\u0456"},...Object.keys(d.QK).map(n=>{const o=d.QK[n].split(" ");return o[0]=o[0].replace(/\u0430$/,"\u0456"),{key:n,value:o.join(" ")}})],this.Roles=q.G}ngOnInit(){this.store.dispatch(_.CP()),this.store.dispatch(_.MV({})),this.actionsForm=new m.cw({status:new m.NI(""),categoryTitle:new m.NI(""),procurementItemTitle:new m.NI("")}),this.user$=this.store.pipe((0,r.Ys)(f.dy)),this.categories$=this.store.pipe((0,r.Ys)(Z.us),(0,A.U)(this.transform)),this.procurementItems$=this.store.pipe((0,r.Ys)(Z.YL),(0,A.U)(this.transform)),this.paramsSubscription=this.store.pipe((0,r.Ys)(l.N2)).subscribe(e=>{this.requestParams=e})}getFormControl(e){return this.actionsForm.get(e)}setRequestParamsStatus(e){this.store.dispatch(p.Nl({requestParams:{...this.requestParams,status:e}}))}setRequestParamsCategory(e){this.store.dispatch(_.MV({categoryTitle:e})),this.store.dispatch(p.Nl({requestParams:{...this.requestParams,categoryTitle:e,procurementItemTitle:""}})),this.getFormControl("procurementItemTitle").setValue("")}setRequestParamsProcurementItem(e){this.store.dispatch(p.Nl({requestParams:{...this.requestParams,procurementItemTitle:e}}))}transform(e){return null==e?[{key:"",value:"\u0412\u0441\u0456"}]:[{key:"",value:"\u0412\u0441\u0456"}].concat(e.map(n=>({key:n.title,value:n.title})))}ngOnDestroy(){this.paramsSubscription&&this.paramsSubscription.unsubscribe()}}return s.\u0275fac=function(e){return new(e||s)(t.Y36(r.yh))},s.\u0275cmp=t.Xpm({type:s,selectors:[["app-requests-actions"]],decls:7,vars:21,consts:[[1,"mt-0","sm:mt-2"],["label","\u0421\u0442\u0430\u0442\u0443\u0441",3,"control","displayProps","items","optionValueProp","required","emitSelectionChangeEvent","onSelectionChange",4,"ngIf"],["label","\u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0456\u044f",3,"control","displayProps","items","optionValueProp","required","emitSelectionChangeEvent","onSelectionChange"],["label","\u041d\u0430\u0437\u0432\u0430 \u043f\u0440\u0435\u0434\u043c\u0435\u0442\u0443 \u0437\u0430\u043a\u0443\u043f\u0456\u0432\u043b\u0456",3,"control","displayProps","items","optionValueProp","required","emitSelectionChangeEvent","onSelectionChange"],["label","\u0421\u0442\u0430\u0442\u0443\u0441",3,"control","displayProps","items","optionValueProp","required","emitSelectionChangeEvent","onSelectionChange"]],template:function(e,n){if(1&e&&(t.TgZ(0,"div",0),t.YNc(1,tt,1,7,"app-dropdown",1),t.ALo(2,"async"),t.TgZ(3,"app-dropdown",2),t.NdJ("onSelectionChange",function(c){return n.setRequestParamsCategory(c)}),t.ALo(4,"async"),t.qZA(),t.TgZ(5,"app-dropdown",3),t.NdJ("onSelectionChange",function(c){return n.setRequestParamsProcurementItem(c)}),t.ALo(6,"async"),t.qZA()()),2&e){let o;t.xp6(1),t.Q6J("ngIf",(null==(o=t.lcZ(2,13,n.user$))?null:o.role)===n.Roles.Applicant),t.xp6(2),t.Q6J("control",n.getFormControl("categoryTitle"))("displayProps",t.DdM(19,h))("items",t.lcZ(4,15,n.categories$))("optionValueProp","key")("required",!1)("emitSelectionChangeEvent",!0),t.xp6(2),t.Q6J("control",n.getFormControl("procurementItemTitle"))("displayProps",t.DdM(20,h))("items",t.lcZ(6,17,n.procurementItems$))("optionValueProp","key")("required",!1)("emitSelectionChangeEvent",!0)}},dependencies:[W.J,a.O5,a.Ov]}),s})();const T=function(){return["h-[45px]","w-auto"]};function st(s,u){if(1&s){const e=t.EpF();t.TgZ(0,"app-button",7),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(2);return t.KtG(o.openCreateRequestDialog())}),t.qZA()}2&s&&t.Q6J("classList",t.DdM(1,T))}function nt(s,u){if(1&s){const e=t.EpF();t.TgZ(0,"app-button",8),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(2);return t.KtG(o.openCreateOrderDialog())}),t.ALo(1,"async"),t.qZA()}if(2&s){const e=t.oxw(2);let n;t.Q6J("classList",t.DdM(4,T))("disabled",!(null!=(n=t.lcZ(1,2,e.orderRequests$))&&n.length))}}function ut(s,u){if(1&s&&(t.TgZ(0,"div"),t.YNc(1,st,1,2,"app-button",5),t.YNc(2,nt,2,5,"app-button",6),t.qZA()),2&s){const e=u.ngIf,n=t.oxw();t.xp6(1),t.Q6J("ngIf",e.role===n.Roles.Applicant),t.xp6(1),t.Q6J("ngIf",e.role===n.Roles.Customer)}}let ot=(()=>{class s{constructor(e){this.store=e,this.Roles=q.G}ngOnInit(){this.user$=this.store.pipe((0,r.Ys)(f.dy)),this.orderRequests$=this.store.pipe((0,r.Ys)(l.Q))}openCreateRequestDialog(){this.store.dispatch(g.tC())}openCreateOrderDialog(){this.store.dispatch(g.aO())}}return s.\u0275fac=function(e){return new(e||s)(t.Y36(r.yh))},s.\u0275cmp=t.Xpm({type:s,selectors:[["app-requests-container"]],decls:9,vars:3,consts:[[1,"w-[90%]","xl:w-4/5","mx-auto","grid","grid-rows-[auto_1fr]","gap-y-4","py-6","sm:py-10"],[1,"grid","grid-rows-[auto_45px]","gap-y-4","sm:flex","sm:flex-row","sm:justify-between","sm:items-center","sm:gap-y-0","sm:h-[45px]"],[1,"text-2xl","font-medium","justify-self-start"],[4,"ngIf"],[1,"grid","grid-cols-1","sm:grid-cols-[25%_1fr]","gap-x-8"],["text","+ \u0421\u0442\u0432\u043e\u0440\u0438\u0442\u0438 \u0437\u0430\u044f\u0432\u043a\u0443","type","button",3,"classList","click",4,"ngIf"],["text","\u0421\u0444\u043e\u0440\u043c\u0443\u0432\u0430\u0442\u0438 \u0437\u0430\u043c\u043e\u0432\u043b\u0435\u043d\u043d\u044f","type","button",3,"classList","disabled","click",4,"ngIf"],["text","+ \u0421\u0442\u0432\u043e\u0440\u0438\u0442\u0438 \u0437\u0430\u044f\u0432\u043a\u0443","type","button",3,"classList","click"],["text","\u0421\u0444\u043e\u0440\u043c\u0443\u0432\u0430\u0442\u0438 \u0437\u0430\u043c\u043e\u0432\u043b\u0435\u043d\u043d\u044f","type","button",3,"classList","disabled","click"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"h1",2),t._uU(3,"\u0417\u0430\u044f\u0432\u043a\u0438"),t.qZA(),t.YNc(4,ut,3,2,"div",3),t.ALo(5,"async"),t.qZA(),t.TgZ(6,"div",4),t._UZ(7,"app-requests-actions")(8,"app-requests-list"),t.qZA()()),2&e&&(t.xp6(4),t.Q6J("ngIf",t.lcZ(5,1,n.user$)))},dependencies:[C.r,a.O5,z,et,a.Ov]}),s})(),it=(()=>{class s{}return s.\u0275fac=function(e){return new(e||s)},s.\u0275mod=t.oAB({type:s}),s.\u0275inj=t.cJS({imports:[b.m,a.ez,I.Bz.forChild([{path:"",component:ot}])]}),s})()}}]);